import pandas as pd
from django.http import HttpResponse
from .models import YourModel

def export_data(request):
    # Fetch the data from the database
    queryset = YourModel.objects.all()

    # Convert the queryset to a Pandas DataFrame
    df = pd.DataFrame(list(queryset.values()))

    # Create a response object with the Excel file
    response = HttpResponse(content_type='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')
    response['Content-Disposition'] = 'attachment; filename="exported_data.xlsx"'

    # Write the DataFrame to the response as an Excel file
    df.to_excel(response, index=False)

    return response